<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PageDriver 对象 | matman.js</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/matman/logo.png">
    <meta name="description" content="web 端对端测试解决方案">
    <link rel="preload" href="/matman/assets/css/0.styles.6d9708a5.css" as="style"><link rel="preload" href="/matman/assets/js/app.e3143995.js" as="script"><link rel="preload" href="/matman/assets/js/3.ca57c110.js" as="script"><link rel="preload" href="/matman/assets/js/2.dab4ebaa.js" as="script"><link rel="preload" href="/matman/assets/js/26.85b84988.js" as="script"><link rel="prefetch" href="/matman/assets/js/10.18d2fbc3.js"><link rel="prefetch" href="/matman/assets/js/11.9019913b.js"><link rel="prefetch" href="/matman/assets/js/12.d0402eb5.js"><link rel="prefetch" href="/matman/assets/js/13.b556a804.js"><link rel="prefetch" href="/matman/assets/js/14.0a809968.js"><link rel="prefetch" href="/matman/assets/js/15.b891806f.js"><link rel="prefetch" href="/matman/assets/js/16.0aa442da.js"><link rel="prefetch" href="/matman/assets/js/17.697ce94f.js"><link rel="prefetch" href="/matman/assets/js/18.c7c73b1b.js"><link rel="prefetch" href="/matman/assets/js/19.b99ac8cd.js"><link rel="prefetch" href="/matman/assets/js/20.ef0eb1f8.js"><link rel="prefetch" href="/matman/assets/js/21.4e253c96.js"><link rel="prefetch" href="/matman/assets/js/22.3c3a6e2e.js"><link rel="prefetch" href="/matman/assets/js/23.58f62223.js"><link rel="prefetch" href="/matman/assets/js/24.a8c04deb.js"><link rel="prefetch" href="/matman/assets/js/25.04f70ab5.js"><link rel="prefetch" href="/matman/assets/js/27.233fe0f8.js"><link rel="prefetch" href="/matman/assets/js/28.44525bbf.js"><link rel="prefetch" href="/matman/assets/js/29.d227d5a8.js"><link rel="prefetch" href="/matman/assets/js/30.55000afc.js"><link rel="prefetch" href="/matman/assets/js/31.65ba1d41.js"><link rel="prefetch" href="/matman/assets/js/32.c3eb68bc.js"><link rel="prefetch" href="/matman/assets/js/33.a1951069.js"><link rel="prefetch" href="/matman/assets/js/34.8f914216.js"><link rel="prefetch" href="/matman/assets/js/35.c05523c2.js"><link rel="prefetch" href="/matman/assets/js/36.a2f9746d.js"><link rel="prefetch" href="/matman/assets/js/37.eb7e74b7.js"><link rel="prefetch" href="/matman/assets/js/38.19df058b.js"><link rel="prefetch" href="/matman/assets/js/39.73a05789.js"><link rel="prefetch" href="/matman/assets/js/4.519a8c10.js"><link rel="prefetch" href="/matman/assets/js/5.09f5e50d.js"><link rel="prefetch" href="/matman/assets/js/6.be81815b.js"><link rel="prefetch" href="/matman/assets/js/7.c4973086.js"><link rel="prefetch" href="/matman/assets/js/8.558ec8a3.js"><link rel="prefetch" href="/matman/assets/js/9.b01c1268.js">
    <link rel="stylesheet" href="/matman/assets/css/0.styles.6d9708a5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container fastest-docs-container"><!----> <header style="background-color:rgba(255, 255, 255, 1);box-shadow:0px 2px 30px 0px rgba(0, 0, 0, 0.1);" data-v-e3902e94><nav data-v-e3902e94><a href="/matman/" class="router-link-active" data-v-e3902e94><img src="/matman/assets/img/logo_100.285fceb1.png" alt="logo" style="height:50px;" data-v-e3902e94></a> <ul class="navs" data-v-e3902e94><li class="nav" data-v-e3902e94><a href="/matman/docs/" class="nav__link--white" style="color:rgba(102, 102, 102, 1);" data-v-e3902e94>web端对端测试方案
                </a> <!----></li><li class="nav" data-v-e3902e94><a href="/matman/api/" class="router-link-active nav__link--white" style="color:rgba(102, 102, 102, 1);" data-v-e3902e94>API手册
                </a> <!----></li><li class="nav" data-v-e3902e94><a href="/matman/tool/" class="nav__link--white" style="color:rgba(102, 102, 102, 1);" data-v-e3902e94>工具
                </a> <!----></li><li class="nav" data-v-e3902e94><a href="/matman/release/" class="nav__link--white" style="color:rgba(102, 102, 102, 1);" data-v-e3902e94>发布日志
                </a> <!----></li><li class="nav" data-v-e3902e94><a href="https://github.com/matmanjs/matman/issues" target="_blank" rel="noopener noreferrer" class="nav__link--white" style="color:rgba(102, 102, 102, 1);" data-v-e3902e94>Issues</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" data-v-e3902e94 data-v-e3902e94><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></li></ul></nav></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/matman/api/" aria-current="page" class="sidebar-link">API说明</a></li><li><a href="/matman/api/matman-config.html" class="sidebar-link">matman.config.js 配置</a></li><li><a href="/matman/api/matman.html" class="sidebar-link">matman API</a></li><li><a href="/matman/api/pageDriver.html" aria-current="page" class="active sidebar-link">PageDriver 对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-pagedriverasync" class="sidebar-link">1. PageDriverAsync</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-1-useproxyserver" class="sidebar-link">1.1 useProxyServer</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-2-usemockstar" class="sidebar-link">1.2 useMockstar</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-3-changemockstar" class="sidebar-link">1.3 changeMockstar</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-4-setcookieconfig" class="sidebar-link">1.4 setCookieConfig</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-5-setdeviceconfig" class="sidebar-link">1.5 setDeviceConfig</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-6-setscreenshotconfig" class="sidebar-link">1.6 setScreenshotConfig</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-7-setcoverageconfig" class="sidebar-link">1.7 setCoverageConfig</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-8-setmatmanresultconfig" class="sidebar-link">1.8 setMatmanResultConfig</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-9-setpageurl" class="sidebar-link">1.9 setPageUrl</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-10-addaction" class="sidebar-link">1.10 addAction</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-11-addrunaction" class="sidebar-link">1.11 addRunAction</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_1-12-evaluate" class="sidebar-link">1.12 evaluate</a></li></ul></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_2-pagedriversync" class="sidebar-link">2. PageDriverSync</a></li><li class="sidebar-sub-header"><a href="/matman/api/pageDriver.html#_3-接口定义" class="sidebar-link">3. 接口定义</a></li></ul></li><li><a href="/matman/api/matman-result.html" class="sidebar-link">MatmanResult 对象</a></li><li><a href="/matman/api/web-crawl-util.html" class="sidebar-link">爬虫工具：web-crawl-util</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="pagedriver-对象"><a href="#pagedriver-对象" class="header-anchor">#</a> PageDriver 对象</h1> <blockquote><ul><li>PageDriverAsync 和 PageDriverSync 中的 API 基本保持一致</li> <li>只是 PageDriverSync 中的成员函数返回的是 PageDriver 本身，PageDriverAsync 中的成员函数一般返回 void</li> <li>具体的示例可以 <a href="https://github.com/matmanjs/test-automation-training/tree/master/matman" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></blockquote> <h2 id="_1-pagedriverasync"><a href="#_1-pagedriverasync" class="header-anchor">#</a> 1. PageDriverAsync</h2> <h3 id="_1-1-useproxyserver"><a href="#_1-1-useproxyserver" class="header-anchor">#</a> 1.1 useProxyServer</h3> <blockquote><p>设置代理服务，<a href="https://github.com/matmanjs/test-automation-training/tree/master/matman/10.mockstar-and-proxy" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">useProxyServer</span><span class="token punctuation">(</span>proxyServer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span>
</code></pre></div><h4 id="_1-1-1-参数"><a href="#_1-1-1-参数" class="header-anchor">#</a> 1.1.1 参数</h4> <ul><li>proxyServer：代理服务地址（String）</li></ul> <h4 id="_1-1-2-返回值"><a href="#_1-1-2-返回值" class="header-anchor">#</a> 1.1.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-2-usemockstar"><a href="#_1-2-usemockstar" class="header-anchor">#</a> 1.2 useMockstar</h3> <blockquote><p>设置 mock 服务中各个接口的返回值（必须与 mockstar 搭配使用），<a href="https://github.com/matmanjs/test-automation-training/tree/master/matman/10.mockstar-and-proxy" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">useMockstar</span><span class="token punctuation">(</span>queryMap<span class="token operator">:</span> MockstarQueryDataMap<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-2-1-参数"><a href="#_1-2-1-参数" class="header-anchor">#</a> 1.2.1 参数</h4> <ul><li>queryMap：mockstar 数据映射（MockstarQueryDataMap），类型定义如下：</li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">MockstarQueryDataMap</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>即接受一个对象，<code>key</code> 为 Mocker 名称，<code>value</code> 为 Mocker 中具体返回结果名称</li></ul> <h4 id="_1-2-2-返回值"><a href="#_1-2-2-返回值" class="header-anchor">#</a> 1.2.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-3-changemockstar"><a href="#_1-3-changemockstar" class="header-anchor">#</a> 1.3 changeMockstar</h3> <blockquote><p>根据需要改变 mock 服务中各个接口的返回值（必须与 mockstar 搭配使用），<a href="https://github.com/matmanjs/test-automation-training/tree/master/matman/10.mockstar-and-proxy" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">changeMockstar</span><span class="token punctuation">(</span>queryDataMap<span class="token operator">:</span> MockstarQueryDataMap<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-3-1-参数"><a href="#_1-3-1-参数" class="header-anchor">#</a> 1.3.1 参数</h4> <ul><li>queryMap：mockstar 数据映射（MockstarQueryDataMap），类型定义如下：</li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">MockstarQueryDataMap</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>即接受一个对象，<code>key</code> 为 Mocker 名称，<code>value</code> 为 Mocker 中具体返回结果名称</li></ul> <h4 id="_1-3-2-返回值"><a href="#_1-3-2-返回值" class="header-anchor">#</a> 1.3.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-4-setcookieconfig"><a href="#_1-4-setcookieconfig" class="header-anchor">#</a> 1.4 setCookieConfig</h3> <blockquote><p>设置 cookie，具体的使用方法可以 <a href="https://github.com/matmanjs/test-automation-training/tree/master/matman/06.set-cookie" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">setCookieConfig</span><span class="token punctuation">(</span>cookieConfig<span class="token operator">:</span> CookieConfigOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-4-1-参数"><a href="#_1-4-1-参数" class="header-anchor">#</a> 1.4.1 参数</h4> <p>cookieConfig：需要注入的 cookie</p> <ul><li>可以传入 <code>符合格式的 cookie 字符串</code>（以分号分割，等号连接的字符串）</li> <li>可以传入 <code>键值映射</code></li> <li>可以传入 <code>对象数组</code>（具体的定义可以 <a href="https://github.com/puppeteer/puppeteer/blob/v4.0.0/docs/api.md#pagesetcookiecookies" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）</li></ul> <p>类型定义如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">CookieMap</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// https://github.com/puppeteer/puppeteer/blob/v4.0.0/docs/api.md#pagesetcookiecookies</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">CookieObject</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  url<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  domain<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  path<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  expires<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  httpOnly<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  secure<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// mykey1=myvalue1; mykey2=myvalue2</span>
<span class="token keyword">type</span> cookieStr <span class="token operator">=</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> CookieConfigOpts <span class="token operator">=</span> cookieStr <span class="token operator">|</span> CookieMap <span class="token operator">|</span> CookieObject<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-4-2-返回值"><a href="#_1-4-2-返回值" class="header-anchor">#</a> 1.4.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-5-setdeviceconfig"><a href="#_1-5-setdeviceconfig" class="header-anchor">#</a> 1.5 setDeviceConfig</h3> <blockquote><p>设置设备参数，比如可以进行 移动端调试，具体的使用方法可以 <a href="https://github.com/matmanjs/test-automation-training/tree/master/matman/04.device-emulation" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">setDeviceConfig</span><span class="token punctuation">(</span>deviceConfig<span class="token operator">:</span> DeviceConfigOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-5-1-参数"><a href="#_1-5-1-参数" class="header-anchor">#</a> 1.5.1 参数</h4> <p>deviceConfig：设备参数设置</p> <ul><li>当传入 <code>string</code> 时，应为你需要指定的设备</li> <li>否则传入<code>object</code></li></ul> <p>类型定义如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Viewport</span> <span class="token punctuation">{</span>
  <span class="token comment">// 页面宽度</span>
  width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token comment">// 页面高度</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token comment">// 设备缩放比例，默认为 1</span>
  deviceScaleFactor<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token comment">// 是否是移动设备</span>
  isMobile<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token comment">// 是否支持触摸事件</span>
  hasTouch<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token comment">// 是否以 landscape 模式运行，默认为 false</span>
  isLandscape<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// https://github.com/puppeteer/puppeteer/blob/main/src/common/DeviceDescriptors.ts</span>
<span class="token keyword">interface</span> <span class="token class-name">Device</span> <span class="token punctuation">{</span>
  <span class="token comment">// 设备名称</span>
  name<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">// UA 设置</span>
  userAgent<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  viewport<span class="token operator">?</span><span class="token operator">:</span> Viewport<span class="token punctuation">;</span>
  <span class="token comment">// 基于哪一个设备扩展</span>
  extend<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> DeviceConfigOpts <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> Device<span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-5-2-返回值"><a href="#_1-5-2-返回值" class="header-anchor">#</a> 1.5.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-6-setscreenshotconfig"><a href="#_1-6-setscreenshotconfig" class="header-anchor">#</a> 1.6 setScreenshotConfig</h3> <blockquote><p>设置截屏配置，具体的使用方法可以 <a href="https://github.com/matmanjs/test-automation-training/tree/master/matman/07.set-screen-shot" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">setScreenshotConfig</span><span class="token punctuation">(</span>screenshotConfig<span class="token operator">:</span> ScreenOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-6-1-参数"><a href="#_1-6-1-参数" class="header-anchor">#</a> 1.6.1 参数</h4> <p>screenshotConfig：截屏配置</p> <ul><li>传入 <code>string</code> 时为文件保存路径（必须带 <code>PNG</code> 后缀）</li> <li><code>boolean</code> 时为是否启动截屏</li> <li><code>object</code> 时为截屏区域设置等</li></ul> <p>类型定义如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">/**
 * 截图区域的配置信息
 */</span>
<span class="token keyword">interface</span> <span class="token class-name">ClipOpts</span> <span class="token punctuation">{</span>
  <span class="token comment">// 区域左上角坐标</span>
  x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token comment">// 截图区域宽高</span>
  width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 是否启用截图, 或者截图保存的文件名路径(如果想对路径, 则相对于basePath 而言), 或者截图配置
 */</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> ScreenOpts <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token punctuation">{</span>
  tag<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  clip<span class="token operator">?</span><span class="token operator">:</span> ClipOpts<span class="token punctuation">;</span>
  fullPage<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-6-2-返回值"><a href="#_1-6-2-返回值" class="header-anchor">#</a> 1.6.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-7-setcoverageconfig"><a href="#_1-7-setcoverageconfig" class="header-anchor">#</a> 1.7 setCoverageConfig</h3> <blockquote><p>设置覆盖率配置，具体使用可以 <a href="https://github.com/matmanjs/test-automation-training/tree/master/matman/08.result-coverage" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">setCoverageConfig</span><span class="token punctuation">(</span>coverageConfig<span class="token operator">:</span> CoverageOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-7-1-参数"><a href="#_1-7-1-参数" class="header-anchor">#</a> 1.7.1 参数</h4> <p>coverageConfig：覆盖率配置参数（CoverageOpts）</p> <ul><li>path：保存覆盖率文件的路径, 如果没有填写就自动生成</li> <li>tag：标记，用于保存多个版本的结果</li></ul> <p>类型定义如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">/**
 * 覆盖率选项
 * 是否启用覆盖率, 或者覆盖率保存的文件名路径 (如果想对路径, 则相对于basePath 而言), 或者覆盖率配置
 *
 * @member opts.path 保存覆盖率文件的路径, 如果没有填写就自动生成
 * @member opts.tag 标记
 */</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> CoverageOpts <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token punctuation">{</span>tag<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-7-2-返回值"><a href="#_1-7-2-返回值" class="header-anchor">#</a> 1.7.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-8-setmatmanresultconfig"><a href="#_1-8-setmatmanresultconfig" class="header-anchor">#</a> 1.8 setMatmanResultConfig</h3> <blockquote><p>设置运行结果保存配置，具体使用可以 <a href="https://github.com/matmanjs/test-automation-training/tree/master/matman/08.result-coverage" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">setMatmanResultConfig</span><span class="token punctuation">(</span>matmanResultConfig<span class="token operator">:</span> ResultOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-8-1-参数"><a href="#_1-8-1-参数" class="header-anchor">#</a> 1.8.1 参数</h4> <p>matmanResultConfig：执行结果保存配置（ResultOpts）</p> <ul><li>path：保存覆盖率文件的路径, 如果没有填写就自动生成</li> <li>tag：标记，用于保存多个版本的结果</li></ul> <p>类型定义如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">/**
 * 执行结果选项
 * 是否启用执行结果，或者执行结果保存的文件名路径(如果想对路径，则相对于basePath 而言)，或者执行结果配置
 *
 * @member opts.path 执行结果保存的完成文件名，如果不填写，则将根据当前路径自动生成名字
 * @member opts.tag 标记
 */</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> ResultOpts <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token punctuation">{</span>tag<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-8-2-返回值"><a href="#_1-8-2-返回值" class="header-anchor">#</a> 1.8.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-9-setpageurl"><a href="#_1-9-setpageurl" class="header-anchor">#</a> 1.9 setPageUrl</h3> <blockquote><p>设置页面 URL</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">setPageUrl</span><span class="token punctuation">(</span>pageUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-9-1-参数"><a href="#_1-9-1-参数" class="header-anchor">#</a> 1.9.1 参数</h4> <ul><li>pageUrl：待测试页面的 URL（string）</li></ul> <h4 id="_1-9-2-返回值"><a href="#_1-9-2-返回值" class="header-anchor">#</a> 1.9.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-10-addaction"><a href="#_1-10-addaction" class="header-anchor">#</a> 1.10 addAction</h3> <blockquote><p>设置页面操作步骤</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">addAction</span><span class="token punctuation">(</span>
  actionName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token function-variable function">actionCall</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">n<span class="token operator">:</span> Nightmare <span class="token operator">&amp;</span> puppeteer<span class="token punctuation">.</span>Page</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Nightmare <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-10-1-参数"><a href="#_1-10-1-参数" class="header-anchor">#</a> 1.10.1 参数</h4> <ul><li>actionName：action 的名称（string）</li> <li>actionCall：需要执行的方法（<code>(n: Nightmare &amp; puppeteer.Page) =&gt; Nightmare | Promise&lt;void&gt;</code>）</li> <li>需要注意的是
<ul><li>当 runner 选择 puppeteer 时，需要传入的函数为异步函数</li> <li>当 runner 选择 Nightmare 时，需要将 Nightmare 实例返回</li></ul></li></ul> <h4 id="_1-10-2-返回值"><a href="#_1-10-2-返回值" class="header-anchor">#</a> 1.10.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-11-addrunaction"><a href="#_1-11-addrunaction" class="header-anchor">#</a> 1.11 addRunAction</h3> <blockquote><p>设置页面操作步骤，但是不产生页面快照</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">addRunAction</span><span class="token punctuation">(</span>
  <span class="token function-variable function">actionCall</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">n<span class="token operator">:</span> Nightmare <span class="token operator">&amp;</span> puppeteer<span class="token punctuation">.</span>Page</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Nightmare <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-11-1-参数"><a href="#_1-11-1-参数" class="header-anchor">#</a> 1.11.1 参数</h4> <ul><li>actionCall：需要执行的方法（<code>(n: Nightmare &amp; puppeteer.Page) =&gt; Nightmare | Promise&lt;void&gt;</code>）</li> <li>需要注意的是
<ul><li>当 runner 选择 puppeteer 时，需要传入的函数为异步函数</li> <li>当 runner 选择 Nightmare 时，需要将 Nightmare 实例返回</li></ul></li></ul> <h4 id="_1-11-2-返回值"><a href="#_1-11-2-返回值" class="header-anchor">#</a> 1.11.2 返回值</h4> <ul><li><code>void</code></li></ul> <h3 id="_1-12-evaluate"><a href="#_1-12-evaluate" class="header-anchor">#</a> 1.12 evaluate</h3> <blockquote><p>设置爬虫、得到结果</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">evaluate</span><span class="token punctuation">(</span>fn<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>MatmanResult <span class="token operator">|</span> PageDriver<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>MatmanResult <span class="token operator">|</span> PageDriver<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-12-1-参数"><a href="#_1-12-1-参数" class="header-anchor">#</a> 1.12.1 参数</h4> <ul><li>evaluate：需要执行的爬虫脚本的路径或者函数（string 或者 Function）</li></ul> <h4 id="_1-12-2-返回值"><a href="#_1-12-2-返回值" class="header-anchor">#</a> 1.12.2 返回值</h4> <ul><li><code>Promise&lt;MatmanResult | PageDriver&gt;</code></li></ul> <h2 id="_2-pagedriversync"><a href="#_2-pagedriversync" class="header-anchor">#</a> 2. PageDriverSync</h2> <ul><li>与 <code>PageDriverAsync</code> 基本一致</li> <li><code>evaluate</code> 与 <code>PageDriverAsync</code> 完全一致</li> <li>除 <code>evaluat</code> 外，其余函数为同步函数且返回 <code>PageDriverSync</code> 本身</li> <li>其余可参考上述部分</li></ul> <h2 id="_3-接口定义"><a href="#_3-接口定义" class="header-anchor">#</a> 3. 接口定义</h2> <p><code>PageDriver</code> 中需要实现的接口如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">PageDriver</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 走指定的代理服务，由代理服务配置请求加载本地项目，从而达到同源测试的目的
   * 若不配置，则之前请求现网，亦可直接测试现网的服务
   *
   * https://github.com/segmentio/nightmare#switches
   *
   * @param {String} proxyServer 代理服务器，格式为 my_proxy_server.example.com:8080，例如 127.0.0.1:8899
   * @return {PageDriver}
   */</span>
  <span class="token function">useProxyServer</span><span class="token punctuation">(</span>proxyServer<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 使用 mockstar 工具来做接口 mock 数据
   *
   * https://github.com/mockstarjs/mockstar
   *
   * @return {PageDriver}
   */</span>
  <span class="token function">useMockstar</span><span class="token punctuation">(</span>queryMap<span class="token operator">:</span> MockstarQueryDataMap<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  
  <span class="token comment">/**
   * 更新 mockstar 中的请求
   *
   * https://github.com/mockstarjs/mockstar
   *
   * @return {PageDriver}
   * @author helinjiang
   */</span>
  <span class="token keyword">async</span> <span class="token function">changeMockstar</span><span class="token punctuation">(</span>queryDataMap<span class="token operator">:</span> MockstarQueryDataMap<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 注入 cookie
   *
   * https://github.com/helinjiang/nightmare-handler/blob/master/docs/exCookies.md
   * https://github.com/helinjiang/nightmare-handler/tree/master/demo/extend-exCookies
   *
   * @param {String | Object } cookieConfig 支持 `mykey1=myvalue1; mykey2=myvalue2` 和 `{mykey1:'myvalue1', mykey2:'myvalue'}` 写法
   * @return {PageDriver}
   */</span>
  <span class="token function">setCookieConfig</span><span class="token punctuation">(</span>cookieConfig<span class="token operator">:</span> CookieConfigOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 设置无头浏览器设备参数
   *
   * https://github.com/helinjiang/nightmare-handler/blob/master/docs/exDevice.md
   *
   * @param {String | Object} deviceConfig 设备名或者设备配置，默认值为 mobile
   * @param {String} [deviceConfig.name] 设备名字
   * @param {String} [deviceConfig.UA] userAgent
   * @param {Number} [deviceConfig.width] 视窗宽度
   * @param {Number} [deviceConfig.height] 视窗高度，注意这里不是指页面的高度，页面高度要小于这个值
   * @return {PageDriver}
   */</span>
  <span class="token function">setDeviceConfig</span><span class="token punctuation">(</span>deviceConfig<span class="token operator">:</span> DeviceConfigOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 设置截屏参数，默认不截图
   *
   * @param {Boolean | String | Object} screenshotConfig
   * @return {PageDriver}
   */</span>
  <span class="token function">setScreenshotConfig</span><span class="token punctuation">(</span>screenshotConfig<span class="token operator">:</span> ScreenOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 设置覆盖率参数
   *
   * @param {Boolean | String | Object} coverageConfig
   * @return {PageDriver}
   */</span>
  <span class="token function">setCoverageConfig</span><span class="token punctuation">(</span>coverageConfig<span class="token operator">:</span> CoverageOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 设置 MatmanResult 执行结果参数
   *
   * @param {Boolean | String | Object} matmanResultConfig
   * @return {PageDriver}
   */</span>
  <span class="token function">setMatmanResultConfig</span><span class="token punctuation">(</span>matmanResultConfig<span class="token operator">:</span> ResultOpts<span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 加载指定的页面地址
   *
   * @param pageUrl
   * @return {PageDriver}
   */</span>
  <span class="token function">setPageUrl</span><span class="token punctuation">(</span>pageUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 增加测试动作
   *
   * @param {String} actionName 动作名称，后续可通过它来获得最后的数据
   * @param {Function} actionCall 执行函数，接受一个 nightmare 对象，可以直接操作
   * @return {PageDriver}
   */</span>
  <span class="token function">addAction</span><span class="token punctuation">(</span>
    actionName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    <span class="token function-variable function">actionCall</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">n<span class="token operator">:</span> Nightmare <span class="token operator">&amp;</span> puppeteer<span class="token punctuation">.</span>Page</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Nightmare <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  
  <span class="token comment">/**
   * 增加执行动作
   *
   * @param {Function} actionCall 执行函数，接受一个 nightmare 或者 puppeteer 对象，可以直接操作
   * @return {PageDriver | Promise&lt;void&gt;}
   */</span>
  <span class="token function">addRunAction</span><span class="token punctuation">(</span>
    <span class="token function-variable function">actionCall</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">n<span class="token operator">:</span> Nightmare <span class="token operator">&amp;</span> puppeteer<span class="token punctuation">.</span>Page</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Nightmare <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> PageDriver <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 执行爬虫脚本或者方法获得结果
   *
   * https://www.npmjs.com/package/nightmare#evaluatefn-arg1-arg2
   *
   * @param {String | Function} fn
   * @param [args]
   * @return {Promise&lt;MatmanResult|PageDriver&gt;}
   */</span>
  <span class="token function">evaluate</span><span class="token punctuation">(</span>fn<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>MatmanResult <span class="token operator">|</span> PageDriver<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>MatmanResult <span class="token operator">|</span> PageDriver<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/matman/api/matman.html" class="prev">
        matman API
      </a></span> <span class="next"><a href="/matman/api/matman-result.html">
        MatmanResult 对象
      </a>
      →
    </span></p></div> </main> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/matman/assets/js/app.e3143995.js" defer></script><script src="/matman/assets/js/3.ca57c110.js" defer></script><script src="/matman/assets/js/2.dab4ebaa.js" defer></script><script src="/matman/assets/js/26.85b84988.js" defer></script>
  </body>
</html>
